<UserControl x:Class="RobotBarApp.View.StatistikView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:lvc="clr-namespace:LiveCharts.Wpf;assembly=LiveCharts.Wpf"
             Background="#FFE5E5E5">

    <UserControl.Resources>
        <!-- Keep the top filter controls aligned and the same height as the Opdater button -->
        <Style x:Key="StatsFilterComboBox" TargetType="ComboBox">
            <Setter Property="Height" Value="35"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style x:Key="StatsFilterDatePicker" TargetType="DatePicker">
            <Setter Property="Height" Value="35"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- Calendar (inside DatePicker popup) -->
        <Style TargetType="CalendarDayButton">
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style TargetType="CalendarButton">
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <!-- Buttons on this page -->
        <Style x:Key="StatsButton" TargetType="Button">
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
    </UserControl.Resources>

    <Grid Margin="30">

        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="2*"/>
            <RowDefinition Height="2*"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,20">

            <!-- EVENT SELECTOR -->
            <StackPanel Margin="0,0,20,0">
                <TextBlock Text="Event:" FontWeight="Bold"/>
                <ComboBox ItemsSource="{Binding Events}"
                          SelectedItem="{Binding SelectedEvent}"
                          DisplayMemberPath="Name"
                          Width="200"
                          Style="{StaticResource StatsFilterComboBox}"/>
            </StackPanel>

            <!-- START DATE + TIME -->
            <StackPanel Margin="0,0,20,0">
                <TextBlock Text="Fra:" FontWeight="Bold"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="160"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="80"/>
                    </Grid.ColumnDefinitions>

                    <DatePicker Grid.Column="0"
                                SelectedDate="{Binding StartDate}"
                                Style="{StaticResource StatsFilterDatePicker}"/>

                    <!-- TIME PICKER -->
                    <ComboBox Grid.Column="2"
                              ItemsSource="{Binding TimeOptions}"
                              SelectedItem="{Binding StartTime}"
                              Style="{StaticResource StatsFilterComboBox}"/>
                </Grid>
            </StackPanel>

            <!-- END DATE + TIME -->
            <StackPanel Margin="0,0,20,0">
                <TextBlock Text="Til:" FontWeight="Bold"/>

                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="160"/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition Width="80"/>
                    </Grid.ColumnDefinitions>

                    <DatePicker Grid.Column="0"
                                SelectedDate="{Binding EndDate}"
                                Style="{StaticResource StatsFilterDatePicker}"/>

                    <ComboBox Grid.Column="2"
                              ItemsSource="{Binding TimeOptions}"
                              SelectedItem="{Binding EndTime}"
                              Style="{StaticResource StatsFilterComboBox}"/>
                </Grid>
            </StackPanel>

            <Button Content="Opdater"
                    Style="{StaticResource StatsButton}"
                    Command="{Binding RefreshStatisticsCommand}"
                    Width="120" Height="35"
                    Margin="10,0,0,0"
                    VerticalAlignment="Bottom"/>
        </StackPanel>

        <!-- DRINKS PIE CHART -->
        <Border Grid.Row="1" Margin="10" Background="White" Padding="20">
            <lvc:PieChart Series="{Binding DrinkPieSeries}"
                          LegendLocation="Right"/>
        </Border>

        <!-- INGREDIENT BAR CHART -->
        <Border Grid.Row="2"
                Margin="10"
                Background="White"
                Padding="20">

            <lvc:CartesianChart
                Series="{Binding IngredientBarSeries}"
                AxisX="{Binding XAxes}"
                AxisY="{Binding YAxes}" />
        </Border>

        <!-- LOG LIST -->
        <Border Grid.Row="3" Margin="10" Background="White" Padding="20">
            <DataGrid MinHeight="100"
                      ItemsSource="{Binding Logs}"
                      AutoGenerateColumns="False"
                      IsReadOnly="True">

                <DataGrid.Columns>
                    <DataGridTextColumn Header="Tid" Binding="{Binding TimeStamp}" Width="200"/>
                    <DataGridTextColumn Header="Type" Binding="{Binding Type}" Width="120"/>
                    <DataGridTextColumn Header="Besked" Binding="{Binding LogMsg}" Width="*"/>
                </DataGrid.Columns>

            </DataGrid>
        </Border>

    </Grid>
</UserControl>
