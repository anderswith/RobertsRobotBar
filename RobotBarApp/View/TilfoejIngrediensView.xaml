<UserControl x:Class="RobotBarApp.View.TilfoejIngrediensView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:conv="clr-namespace:RobotBarApp.Converters"
             mc:Ignorable="d"
             d:DesignHeight="600"
             d:DesignWidth="1000"
             Background="#FFE5E5E5">

    <UserControl.Resources>
        <conv:PathToImageConverter x:Key="PathToImageConverter" />
        <conv:BooleanToVisibilityConverter x:Key="BoolToVis" />
        <conv:HexToBrushConverter x:Key="HexToBrushConverter" />

        <!-- Make all form labels consistent by default -->
        <Style TargetType="TextBlock">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <!-- Bigger/clearer text inputs (prevents p/q from being clipped) -->
        <Style x:Key="FormTextBoxStyle" TargetType="TextBox">
            <Setter Property="MinHeight" Value="40"/>
            <Setter Property="Padding" Value="10,6"/>
            <Setter Property="VerticalContentAlignment" Value="Center"/>
        </Style>

        <!-- Shared spacing so the form feels less cramped -->
        <Thickness x:Key="RowMargin">0,8,0,18</Thickness>

        <!-- Bigger radio button circle (bullet) for better readability/touch targets -->
        <Style x:Key="BigRadioButton" TargetType="RadioButton">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="RadioButton">
                        <BulletDecorator Background="Transparent">
                            <BulletDecorator.Bullet>
                                <Grid Width="22" Height="22">
                                    <Ellipse x:Name="Outer"
                                             Fill="White"
                                             Stroke="Black"
                                             StrokeThickness="2"/>
                                    <Ellipse x:Name="Inner"
                                             Width="10" Height="10"
                                             Fill="Black"
                                             Opacity="0"/>
                                </Grid>
                            </BulletDecorator.Bullet>

                            <ContentPresenter Margin="10,0,0,0"
                                              VerticalAlignment="Center"
                                              RecognizesAccessKey="True"/>
                        </BulletDecorator>

                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked" Value="True">
                                <Setter TargetName="Inner" Property="Opacity" Value="1"/>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Outer" Property="Opacity" Value="0.45"/>
                                <Setter TargetName="Inner" Property="Opacity" Value="0.45"/>
                                <Setter Property="Foreground" Value="#FF888888"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Smaller button text (keep labels/inputs large) -->
        <Style TargetType="Button">
            <Setter Property="FontSize" Value="16"/>
        </Style>
    </UserControl.Resources>

    <!-- Center the form, but keep it responsive (uses more space on large screens without hugging edges) -->
    <Grid>
        <Border HorizontalAlignment="Center"
                VerticalAlignment="Top"
                Margin="40,60,40,30"
                Padding="30"
                Width="1000"
                MaxWidth="1200"
                Background="Transparent">

            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />   <!-- Title -->
                    <RowDefinition Height="12" />
                    <RowDefinition Height="Auto" />   <!-- Divider -->
                    <RowDefinition Height="28" />

                    <RowDefinition Height="Auto" />   <!-- Navn / Farve / Billede -->
                    <RowDefinition Height="32" />
                    <RowDefinition Height="Auto" />   <!-- Type -->
                    <RowDefinition Height="32" />
                    <RowDefinition Height="Auto" />   <!-- Holder(e) -->
                    <RowDefinition Height="32" />
                    <RowDefinition Height="Auto" />   <!-- SingleScript -->
                    <RowDefinition Height="18" />
                    <RowDefinition Height="Auto" />   <!-- DoubleScript -->
                    <RowDefinition Height="32" />
                    <RowDefinition Height="Auto" />   <!-- Buttons -->
                </Grid.RowDefinitions>

                <!-- Outer layout: label column + content column -->
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="160" />
                    <ColumnDefinition Width="20" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <!-- Title -->
                <TextBlock Grid.Row="0" Grid.Column="0" Grid.ColumnSpan="3"
                           Text="{Binding PageTitle}"
                           FontSize="26"
                           FontWeight="SemiBold" />

                <!-- Divider -->
                <Border Grid.Row="2" Grid.Column="0" Grid.ColumnSpan="3"
                        BorderBrush="#FFCCCCCC"
                        BorderThickness="0,0,0,1" />

                <!-- Row 0: Navn + Farve + Billede -->
                <TextBlock Grid.Row="4" Grid.Column="0"
                           VerticalAlignment="Center"
                           FontSize="18"
                           Text="Navn:"/>

                <Grid Grid.Row="4" Grid.Column="2" Margin="{StaticResource RowMargin}">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="20" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="10" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="12" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="6" />
                        <ColumnDefinition Width="70" />
                        <ColumnDefinition Width="10" />
                        <ColumnDefinition Width="90" />
                    </Grid.ColumnDefinitions>

                    <Grid Grid.Column="0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>

                        <TextBox Grid.Row="0"
                                 Style="{StaticResource FormTextBoxStyle}"
                                 Height="40"
                                 FontSize="18"
                                 HorizontalAlignment="Stretch"
                                 MaxLength="30"
                                 Text="{Binding IngredientName, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                        <TextBlock Grid.Row="1"
                                   Margin="2,2,0,0"
                                   FontSize="12"
                                   Foreground="#FF666666"
                                   Text="(maks. 30 tegn)" />
                    </Grid>

                    <TextBlock Grid.Column="2"
                               VerticalAlignment="Center"
                               FontSize="18"
                               Text="Farve:"/>

                    <Grid Grid.Column="4"
                          Height="40"
                          HorizontalAlignment="Stretch">

                        <Border Background="{Binding Color}"
                                BorderThickness="1"
                                BorderBrush="#FFB0B0B0"
                                HorizontalAlignment="Stretch"
                                VerticalAlignment="Stretch"
                                IsHitTestVisible="False"/>

                        <ComboBox ItemsSource="{Binding AvailableColors}"
                                  Height="40"
                                  FontSize="18"
                                  SelectedValuePath="Hex"
                                  SelectedValue="{Binding Color, Mode=TwoWay}"
                                  Background="Transparent"
                                  BorderThickness="0"
                                  HorizontalContentAlignment="Stretch"
                                  VerticalContentAlignment="Center">

                            <ComboBox.ItemContainerStyle>
                                <Style TargetType="ComboBoxItem">
                                    <Setter Property="HorizontalContentAlignment" Value="Stretch"/>
                                    <Setter Property="Padding" Value="0"/>
                                </Style>
                            </ComboBox.ItemContainerStyle>

                            <!-- Replace the invalid MultiBinding with a normal Binding using HexToBrushConverter -->
                            <ComboBox.ItemTemplate>
                                <DataTemplate>
                                    <Border Height="26"
                                            Background="{Binding Hex, Converter={StaticResource HexToBrushConverter}}"
                                            BorderBrush="Black"
                                            BorderThickness="1"
                                            Margin="2"/>
                                </DataTemplate>
                            </ComboBox.ItemTemplate>

                        </ComboBox>
                    </Grid>

                    <TextBlock Grid.Column="6"
                               VerticalAlignment="Center"
                               FontSize="18"
                               Text="Billede:"/>

                    <Border Grid.Column="8"
                            Width="70" Height="44"
                            BorderBrush="Black"
                            BorderThickness="2"
                            Background="White">
                        <Image Source="{Binding ImagePreview, Converter={StaticResource PathToImageConverter}}"
                               Stretch="Uniform" />
                    </Border>

                    <Button Grid.Column="10"
                            Content="Vælg"
                            Width="90"
                            Height="44"
                            Padding="10,2"
                            Command="{Binding ChooseImageCommand}" />
                </Grid>

                <!-- Row 2: Type -->
                <TextBlock Grid.Row="6" Grid.Column="0"
                           VerticalAlignment="Center"
                           FontSize="18"
                           Text="Type:"/>

                <WrapPanel Grid.Row="6" Grid.Column="2"
                           Margin="{StaticResource RowMargin}"
                           VerticalAlignment="Center">
                    <RadioButton Content="Alkohol"
                                 GroupName="TypeGroup"
                                 Style="{StaticResource BigRadioButton}"
                                 Margin="0,0,24,0"
                                 IsChecked="{Binding IsAlkohol, Mode=TwoWay}" />
                    <RadioButton Content="Mock"
                                 GroupName="TypeGroup"
                                 Style="{StaticResource BigRadioButton}"
                                 Margin="0,0,24,0"
                                 IsChecked="{Binding IsMock, Mode=TwoWay}" />
                    <RadioButton Content="Syrup"
                                 GroupName="TypeGroup"
                                 Style="{StaticResource BigRadioButton}"
                                 Margin="0,0,24,0"
                                 IsChecked="{Binding IsSyrup, Mode=TwoWay}" />
                    <RadioButton Content="Sodavand/saftevand"
                                 GroupName="TypeGroup"
                                 Style="{StaticResource BigRadioButton}"
                                 IsChecked="{Binding IsSoda, Mode=TwoWay}" />
                </WrapPanel>

                <!-- Row 4: Holder(e) -->
                <TextBlock Grid.Row="8" Grid.Column="0"
                           VerticalAlignment="Center"
                           FontSize="18"
                           Text="Holder(e):"/>

                <ComboBox Grid.Row="8" Grid.Column="2"
                          Height="35"
                          Width="220"
                          FontSize="18"
                          Margin="{StaticResource RowMargin}"
                          HorizontalAlignment="Left"
                          ItemsSource="{Binding Holders}"
                          SelectedItem="{Binding SelectedHolder, Mode=TwoWay}" />

                <!-- Row 6: SingleScript -->
                <TextBlock Grid.Row="10" Grid.Column="0"
                           VerticalAlignment="Center"
                           FontSize="18"
                           Text="SingleScript:"/>

                <TextBox Grid.Row="10" Grid.Column="2"
                         Style="{StaticResource FormTextBoxStyle}"
                         Height="40"
                         FontSize="18"
                         Margin="{StaticResource RowMargin}"
                         HorizontalAlignment="Stretch"
                         Text="{Binding SingleScriptText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}" />

                <!-- Row 8: DoubleScript -->
                <TextBlock Grid.Row="12" Grid.Column="0"
                           VerticalAlignment="Center"
                           FontSize="18"
                           Text="DoubleScript:"
                           Visibility="{Binding ShowDoubleScript, Converter={StaticResource BoolToVis}}"/>

                <TextBox Grid.Row="12" Grid.Column="2"
                         Style="{StaticResource FormTextBoxStyle}"
                         Height="40"
                         FontSize="18"
                         Margin="{StaticResource RowMargin}"
                         HorizontalAlignment="Stretch"
                         Text="{Binding DoubleScriptText, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                         Visibility="{Binding ShowDoubleScript, Converter={StaticResource BoolToVis}}" />

                <!-- Row: Buttons -->
                <Grid Grid.Row="14" Grid.Column="0" Grid.ColumnSpan="3" Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <Button Grid.Column="0"
                            Content="Guide"
                            Width="120"
                            Height="40"
                            HorizontalAlignment="Left"
                            VerticalAlignment="Center"
                            Background="#FFB0B0B0"
                            BorderBrush="#FF888888"
                            Command="{Binding GuideCommand}" />

                    <StackPanel Grid.Column="1"
                                Orientation="Horizontal"
                                HorizontalAlignment="Right">
                        <Button Content="Run Test Script"
                                Width="140"
                                Height="40"
                                Background="White"
                                Margin="0,0,12,0"
                                Command="{Binding RunTestScriptCommand}" />
                        <Button Content="Annullér"
                                Width="120"
                                Height="40"
                                Background="White"
                                Margin="0,0,12,0"
                                Command="{Binding CancelCommand}" />
                        <Button Content="Gem"
                                Width="120"
                                Height="40"
                                Background="#FF6BE86B"
                                Command="{Binding SaveCommand}" />
                    </StackPanel>
                </Grid>

            </Grid>
        </Border>
    </Grid>
</UserControl>
